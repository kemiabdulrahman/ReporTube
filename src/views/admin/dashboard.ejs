<%- include('../partials/header', { title: 'Admin Dashboard' }) %>

<section class="section">
  <div class="container">
    <h2 class="title is-3 has-text-weight-bold mb-5">
      <span class="icon"><i class="bi bi-speedometer2"></i></span>
      Admin Dashboard
    </h2>

    <!-- Stats Cards -->
    <div class="columns is-multiline">
      <div class="column is-3-desktop is-6-tablet is-12-mobile">
        <div class="box has-background-primary has-text-white">
          <div class="is-flex is-justify-content-space-between is-align-items-center">
            <div>
              <p class="is-uppercase has-text-weight-semibold">Classes</p>
              <h2 class="title is-2 has-text-white"><%= stats.totalClasses %></h2>
            </div>
            <i class="bi bi-building" style="font-size: 3rem; opacity: 0.3;"></i>
          </div>
          <a href="/admin/classes" class="has-text-white is-flex is-align-items-center mt-3">
            <span>View Details</span>
            <i class="bi bi-arrow-right ml-2"></i>
          </a>
        </div>
      </div>

      <div class="column is-3-desktop is-6-tablet is-12-mobile">
        <div class="box has-background-success has-text-white">
          <div class="is-flex is-justify-content-space-between is-align-items-center">
            <div>
              <p class="is-uppercase has-text-weight-semibold">Students</p>
              <h2 class="title is-2 has-text-white"><%= stats.totalStudents %></h2>
            </div>
            <i class="bi bi-people" style="font-size: 3rem; opacity: 0.3;"></i>
          </div>
          <a href="/admin/students" class="has-text-white is-flex is-align-items-center mt-3">
            <span>View Details</span>
            <i class="bi bi-arrow-right ml-2"></i>
          </a>
        </div>
      </div>

      <div class="column is-3-desktop is-6-tablet is-12-mobile">
        <div class="box has-background-info has-text-white">
          <div class="is-flex is-justify-content-space-between is-align-items-center">
            <div>
              <p class="is-uppercase has-text-weight-semibold">Teachers</p>
              <h2 class="title is-2 has-text-white"><%= stats.totalTeachers %></h2>
            </div>
            <i class="bi bi-person-badge" style="font-size: 3rem; opacity: 0.3;"></i>
          </div>
          <a href="/admin/users" class="has-text-white is-flex is-align-items-center mt-3">
            <span>View Details</span>
            <i class="bi bi-arrow-right ml-2"></i>
          </a>
        </div>
      </div>

      <div class="column is-3-desktop is-6-tablet is-12-mobile">
        <div class="box has-background-warning has-text-white">
          <div class="is-flex is-justify-content-space-between is-align-items-center">
            <div>
              <p class="is-uppercase has-text-weight-semibold">Subjects</p>
              <h2 class="title is-2 has-text-white"><%= stats.totalSubjects %></h2>
            </div>
            <i class="bi bi-book" style="font-size: 3rem; opacity: 0.3;"></i>
          </div>
          <a href="/admin/subjects" class="has-text-white is-flex is-align-items-center mt-3">
            <span>View Details</span>
            <i class="bi bi-arrow-right ml-2"></i>
          </a>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="box mt-6">
      <h5 class="title is-5 has-background-grey-dark has-text-white p-3 mb-4">
        <span class="icon"><i class="bi bi-lightning"></i></span> Quick Actions
      </h5>

      <div class="columns is-multiline">
        <div class="column is-3-desktop is-6-tablet is-12-mobile">
          <a href="/admin/students/add" class="button is-link is-fullwidth">
            <span class="icon"><i class="bi bi-person-plus"></i></span>
            <span>Add Student</span>
          </a>
        </div>

        <div class="column is-3-desktop is-6-tablet is-12-mobile">
          <a href="/admin/classes/add" class="button is-success is-fullwidth">
            <span class="icon"><i class="bi bi-plus-circle"></i></span>
            <span>Add Class</span>
          </a>
        </div>

        <div class="column is-3-desktop is-6-tablet is-12-mobile">
          <a href="/admin/users/add" class="button is-info is-fullwidth">
            <span class="icon"><i class="bi bi-person-badge-fill"></i></span>
            <span>Add User</span>
          </a>
        </div>

        <div class="column is-3-desktop is-6-tablet is-12-mobile">
          <a href="/admin/reports/send" class="button is-warning is-fullwidth">
            <span class="icon"><i class="bi bi-envelope"></i></span>
            <span>Send Reports</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Recent Students -->
    <div class="box mt-6">
      <h5 class="title is-5 mb-4">
        <span class="icon"><i class="bi bi-clock-history"></i></span>
        Recently Added Students
      </h5>

      <% if (students.length > 0) { %>
        <div class="table-container">
          <table class="table is-striped is-hoverable is-fullwidth">
            <thead>
              <tr>
                <th>Admission No.</th>
                <th>Name</th>
                <th>Class</th>
                <th>Parent Email</th>
                <th>Added On</th>
              </tr>
            </thead>
            <tbody>
              <% students.forEach(student => { %>
                <tr>
                  <td><%= student.admission_number %></td>
                  <td><%= student.first_name %> <%= student.last_name %></td>
                  <td><%= student.class_name || 'N/A' %></td>
                  <td><%= student.parent_email || 'N/A' %></td>
                  <td><%= new Date(student.created_at).toLocaleDateString() %></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      <% } else { %>
        <p class="has-text-grey has-text-centered">No students added yet.</p>
      <% } %>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>
